# 修訂版本管理模組

## 功能概述

修訂版本管理模組是 WU工具箱 的一個重要組件，專門用於管理和限制 WordPress 文章修訂版本數量，防止資料庫膨脹，提升網站效能。

## 主要功能

### 1. 修訂版本數量限制
- **管理員控制**：只有管理員可以開啟/關閉此功能
- **自定義數量**：可設定每個文章/頁面保留的最大修訂版本數量（1-100個）
- **文章類型選擇**：可選擇哪些文章類型適用此限制（如：文章、頁面、自定義文章類型）

### 2. 一鍵清理功能
- **批量移除**：一鍵移除所有現有的修訂版本
- **安全確認**：操作前會顯示確認對話框，防止誤操作
- **事務處理**：使用資料庫事務確保操作的安全性

### 3. 統計監控
- **即時統計**：顯示當前修訂版本總數、受影響文章數量
- **大小估算**：估算修訂版本對資料庫大小的影響
- **效能監控**：幫助管理員了解修訂版本對系統的影響

## 技術特點

### 安全性
- 權限檢查：只有 `manage_options` 權限的用戶才能操作
- Nonce 驗證：防止 CSRF 攻擊
- 資料庫事務：確保操作的原子性

### 效能優化
- 自動載入：模組按需載入，不影響其他功能
- 快取清理：操作完成後自動清理 WordPress 快取
- 資料庫優化：自動清理孤立的 meta 資料

### 用戶體驗
- 響應式設計：支援不同螢幕尺寸
- AJAX 操作：無需頁面重新載入即可完成操作
- 即時反饋：操作結果即時顯示

## 使用方法

### 1. 啟用功能
1. 進入 WordPress 後台 → WU工具箱 → 修訂版本管理
2. 勾選「啟用修訂版本數量限制」
3. 設定最大修訂版本數量（建議：5-10個）
4. 選擇適用的文章類型
5. 點擊「儲存設定」

### 2. 清理修訂版本
1. 在修訂版本管理頁面查看當前統計
2. 點擊「一鍵移除所有修訂版本」按鈕
3. 確認操作（此操作無法復原）
4. 等待操作完成

### 3. 監控效能
- 定期查看修訂版本統計
- 監控資料庫大小變化
- 根據需要調整修訂版本數量限制

## 注意事項

### ⚠️ 重要提醒
- **永久性操作**：移除修訂版本是永久性操作，無法復原
- **備份建議**：操作前建議備份資料庫
- **效能影響**：大量修訂版本會影響資料庫查詢效能

### 🔧 最佳實踐
- 建議每個文章保留 5-10 個修訂版本
- 定期清理過多的修訂版本
- 監控資料庫大小和查詢效能
- 根據網站更新頻率調整設定

## 技術規格

### 系統要求
- WordPress 5.0+
- PHP 7.4+
- MySQL 5.7+ 或 MariaDB 10.2+

### 資料庫影響
- 每個修訂版本約佔用 2KB 資料庫空間
- 自動清理孤立的 postmeta 資料
- 支援大型資料庫操作

### 相容性
- 與其他 WordPress 插件相容
- 不影響現有的修訂版本功能
- 支援自定義文章類型

## 故障排除

### 常見問題

**Q: 為什麼無法看到修訂版本管理選單？**
A: 請確認您有 `manage_options` 權限，且插件已正確啟用。

**Q: 清理修訂版本後網站變慢了？**
A: 這是正常現象，WordPress 需要重新建立快取。請等待幾分鐘或手動清理快取。

**Q: 可以恢復已刪除的修訂版本嗎？**
A: 不可以，刪除操作是永久性的。建議操作前備份資料庫。

### 錯誤處理
- 資料庫連接錯誤：檢查資料庫連接設定
- 權限不足：確認用戶權限設定
- 操作失敗：檢查資料庫日誌，必要時聯繫主機商

## 更新日誌

### v1.0.0 (2024-01-XX)
- 初始版本發布
- 基本修訂版本限制功能
- 一鍵清理功能
- 統計監控功能
- 管理員介面

## 支援與反饋

如果您在使用過程中遇到問題或有改進建議，請：
1. 檢查本文檔的故障排除部分
2. 查看 WordPress 錯誤日誌
3. 聯繫技術支援團隊

---

**版本**：1.0.0  
**最後更新**：2024年1月  
**相容性**：WordPress 5.0+